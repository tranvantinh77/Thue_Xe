<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8"/>
    <title th:replace="~{fragments/layoutAdmin :: title}">Title</title>

    <th:block th:insert="~{fragments/layoutAdmin :: meta}"></th:block>

    <th:block th:insert="~{fragments/layoutAdmin :: link}"></th:block>

    <th:block th:insert="~{fragments/layoutAdmin :: head/script}"></th:block>


</head>
<body class="page-header-fixed page-sidebar-closed-hide-logo page-content-white">
<div class="page-wrapper">
    <!-- BEGIN HEADER -->
    <div th:insert="~{fragments/headerAdminPartial :: headerAdminPartial}"></div>
    <!-- END HEADER -->
    <!-- BEGIN HEADER & CONTENT DIVIDER -->
    <div class="clearfix"></div>
    <!-- END HEADER & CONTENT DIVIDER -->
    <!-- BEGIN CONTAINER -->
    <div class="page-container">
        <!-- BEGIN PROGRESSBAR -->
        <div th:insert="~{fragments/loadingPartial :: loadingPartial}"></div>
        <!-- END PROGRESSBAR -->
        <!-- BEGIN PROGRESSBAR -->
        <div th:insert="~{fragments/progressBarPartial :: progressBarPartial}"></div>
        <!-- END PROGRESSBAR -->
        <!-- BEGIN NOTIFICATION -->
        <div th:insert="~{fragments/notificationPartial :: notificationPartial}"></div>
        <!-- END NOTIFICATION -->
        <!-- BEGIN SIDEBAR -->
        <div class="page-sidebar-wrapper">
            <!-- BEGIN SIDEBAR -->
            <div class="page-sidebar navbar-collapse collapse ">
                <ul class="page-sidebar-menu page-header-fixed" data-keep-expanded="false" data-auto-scroll="true"
                    data-slide-speed="200">
                    <li class="sidebar-toggler-wrapper hide">
                        <div class="sidebar-toggler">
                            <span></span>
                        </div>
                    </li>
                    <li class="nav-item" id="nav-none">
                        <a th:href="@{/admin}" class="nav-link nav-toggle">
                            <i class="icon-home"></i>
                            <span class="uppercase title">Trang chủ</span>
                            <span class="selected"></span></a>
                    </li>
                    <li class="nav-item" id="nav-b35fa3f4-4b89-4e9c-9693-5ab7fba3e8ef">
                        <a class="nav-link nav-toggle">
                            <i class="icon-user"></i>
                            <span class="uppercase title">Quản lý xe</span>
                            <span class="arrow" id="nav-span-b35fa3f4-4b89-4e9c-9693-5ab7fba3e8ef"></span>
                        </a>
                        <ul class="sub-menu">
                            <li class="nav-item" id="nav-patronmanagement-insert">
                                <a th:href="@{/admin/oto/insert}" class="nav-link">
                                    <span class="title">Thêm mới</span>
                                </a>
                            </li>
                            <li class="nav-item" id="nav-patronmanagement-list">
                                <a th:href="@{/admin/oto/list}" class="nav-link">
                                    <span class="title">Danh sách</span>
                                </a>
                            </li>
                            <li class="nav-item" id="nav-blockedtracking-list">
                                <a th:href="@{/admin/carcompany/list}" class="nav-link">
                                    <span class="title">Hãng xe</span>
                                </a>
                            </li>
                            <li class="nav-item" id="nav-renewcardlog-list">
                                <a th:href="@{/admin/category/list}" class="nav-link">
                                    <span class="title">Loại xe</span>
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li class="nav-item" id="nav-0765c183-3c39-4a56-af3c-1fa4119698ca">
                        <a class="nav-link nav-toggle">
                            <i class="icon-notebook"></i>
                            <span class="uppercase title">Quản lý sách giấy</span>
                            <span class="arrow" id="nav-span-0765c183-3c39-4a56-af3c-1fa4119698ca"></span>
                        </a>
                        <ul class="sub-menu">
                            <li class="nav-item" id="nav-bibliographic-update">
                                <a href="/admin/booksmanagement/insert" class="nav-link">
                                    <span class="title">Thêm mới</span>
                                </a>
                            </li>
                            <li class="nav-item" id="nav-bibliographic-list">
                                <a href="/admin/booksmanagement/list" class="nav-link">
                                    <span class="title">Danh sách</span>
                                </a>
                            </li>
                            <li class="nav-item" id="nav-bibliographic-tools">
                                <a class="nav-link nav-toggle">
                                    <span class="title">Công cụ</span>
                                    <span class="arrow" id="nav-span-bibliographic-tools"></span>
                                </a>
                                <ul class="sub-menu">
                                    <li class="nav-item" id="nav-cataloging-bibliographic-materialmanagement">
                                        <a href="/admin/materialmanagement/list" class="nav-link ">
                                            <span class="title">Loại tài liệu</span>
                                        </a>
                                    </li>
                                    <li class="nav-item" id="nav-cataloging-bibliographic-mediatypemanagement">
                                        <a href="/admin/mediatypemanagement/list" class="nav-link ">
                                            <span class="title">Thể loại lưu trữ</span>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li class="nav-item" id="nav-0e19b78e-9757-4394-837d-d3d9ebc33dfc">
                        <a class="nav-link nav-toggle">
                            <i class="icon-calculator"></i>
                            <span class="uppercase title">Quản lý mượn trả</span>
                            <span class="arrow" id="nav-span-0e19b78e-9757-4394-837d-d3d9ebc33dfc"></span>
                        </a>
                        <ul class="sub-menu">
                            <li class="nav-item" id="nav-checkout-index">
                                <a href="/admin/checkout/index" class="nav-link">
                                    <span class="title">Mượn trả</span>
                                </a>
                            </li>
                            <li class="nav-item" id="nav-circulation-history">
                                <a href="/admin/circulation/history" class="nav-link">
                                    <span class="title">Nhật ký lưu thông</span>
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li class="nav-item" id="nav-0e19b78e-9757-4394-837d-d3d9ebc33dfd">
                        <a class="nav-link nav-toggle">
                            <i class="icon-social-dribbble"></i>
                            <span class="uppercase title">Quản lý cổng thông tin</span>
                            <span class="arrow" id="nav-span-0e19b78e-9757-4394-837d-d3d9ebc33dfd"></span>
                        </a>
                        <ul class="sub-menu">
                            <li class="nav-item" id="nav-sitemanagement-list">
                                <a href="/admin/sitemanagement/list" class="nav-link">
                                    <span class="title">Quản lý site</span>
                                </a>
                            </li>
                            <li class="nav-item" id="nav-newsmanagement-list">
                                <a class="nav-link nav-toggle">
                                    <span class="title">Quản lý tin tức</span>
                                    <span class="arrow" id="nav-span-newsmanagement-list"></span>
                                </a>
                                <ul class="sub-menu">
                                    <li class="nav-item" id="nav-portaladmin-newsmanagement-newsmanagement">
                                        <a href="/admin/newsmanagement/list" class="nav-link ">
                                            <span class="title">Tin tức</span>
                                        </a>
                                    </li>
                                    <li class="nav-item" id="nav-portaladmin-newsmanagement-categorymanagement">
                                        <a href="/admin/categorymanagement/list" class="nav-link ">
                                            <span class="title">Chuyên mục</span>
                                        </a>
                                    </li>
                                    <li class="nav-item" id="nav-portaladmin-newsmanagement-authormanagement">
                                        <a href="/admin/authormanagement/list" class="nav-link ">
                                            <span class="title">Tác giả</span>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                            <li class="nav-item" id="nav-filesmanagement-list">
                                <a href="/admin/filesmanagement/list" class="nav-link">
                                    <span class="title">Quản lý tập tin</span>
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li class="nav-item active open" id="nav-226a6b8c-2fe3-4ef4-9405-c4cb5d728cef">
                        <a class="nav-link nav-toggle">
                            <i class="icon-users"></i>
                            <span class="uppercase title">Quản lý người dùng</span>
                            <span class="arrow" id="nav-span-226a6b8c-2fe3-4ef4-9405-c4cb5d728cef"></span>
                        </a>
                        <ul class="sub-menu">
                            <li class="nav-item active open" id="nav-usermanagement-list">
                                <a th:href="@{/admin/user/list}" class="nav-link">
                                    <span class="title">Người dùng</span>
                                </a>
                            </li>
                        </ul>
                    </li>

                </ul>
                <!-- END SIDEBAR MENU -->
                <!-- END SIDEBAR MENU -->
            </div>
            <!-- END SIDEBAR -->
        </div>
        <!-- END SIDEBAR -->
        <!-- BEGIN CONTENT -->
        <div class="page-content-wrapper">
            <!-- BEGIN CONTENT BODY -->
            <div class="page-content lv-pageContent">
                <!-- BEGIN PAGE BAR -->
                <div class="page-bar">
                    <ul class="page-breadcrumb">
                        <li>
                            <a th:href="@{/admin}">Trang chủ</a>
                            <i class="fa fa-angle-right"></i>
                        </li>
                        <li>
                            <a href="">Quản lý người dùng</a>
                            <i class="fa fa-angle-right"></i>
                        </li>
                        <li>
                            <a th:href="@{/admin/user/list}">Người dùng</a>
                        </li>
                    </ul>
                </div>
                <!-- END PAGE BAR -->
                <div class="page-content-main page-search">
                    <div class="page-content-1zone">
                        <div class="portlet light pt0 pb0">
                            <div class="portlet-body pb0">
                                <!--SEARCH-->
                                <div class="search-box">
                                    <form th:action="@{/admin/user/search}" method="GET">
                                        <div class="row">
                                            <div class="col-md-12 xs-mt-12">
                                                <div class="input-search-single">
                                                    <input autofocus type="text" name="keyword" id="keyword"
                                                           class="form-control"
                                                           placeholder="Nhập từ khóa ...">
                                                    <button type="submit" class="btn green mr0 btn-search-text-single">
                                                        <i class="icon-magnifier mr5"></i>Tìm kiếm
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                </div><!--END SEARCH-->
                                <!--LIST CONTENT-->
                                <div id="body-content">

                                    <div class="row mt10">
                                        <div class="col-md-6">
                                            <div class="doc-group-title">
                                                <span aria-hidden="true" class="fa fa-user-secret"></span>
                                                Tìm thấy tổng số <span id="lbl-getpaging-total"
                                                                       class="span-total"
                                                                       th:text="${list.size()}"></span>biểu ghi
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="doc-group-title pull-right">
                                                <a th:href="@{/admin/user/insert}"
                                                   class="btn green">
                                                    <i class="icon icon-plus mr5"></i>
                                                    Thêm
                                                </a>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row mt10">
                                        <div class="col-md-12">
                                            <div class="searh-result">
                                                <div id="table-scroll" class="table-scroll">
                                                    <div class="table-scrollable" style="min-height:initial !important">
                                                        <table class="table table-bordered main-table"
                                                               style="width: 1600px">
                                                            <thead class="flip-content1">
                                                            <tr>
                                                                <th class="text-center" style="width: 40px">#</th>
                                                                <th class="text-center">Tên</th>
                                                                <th class="text-center">Email</th>
                                                                <th class="text-center">Giới tính</th>
                                                                <th class="text-center">Phân quyền</th>
                                                                <th class="text-center">Trạng thái</th>
                                                                <th class="text-center">Thao tác</th>
                                                            </tr>
                                                            </thead>

                                                            <tbody id="bodyView">
                                                            <tr th:each="user,iterStat : ${userInfo}">
                                                                <td class="text-center" th:text="${iterStat.count+(pagesize*(currentPage))}">#</td>
                                                                <td th:text="${user.user_info_id.name}">Tên</td>
                                                                <td th:text="${user.user_info_id.email}">Email</td>
                                                                <td class="text-center" th:utext="${user.user_info_id.genderDisplay()}">Giới tính</td>
                                                                <td class="text-center" th:text="${user.role_id.role_name}">Phân quyền</td>
                                                                <td class="text-center" th:utext="${user.statusDisplay()}">Trạng thái</td>

                                                                <td class="text-right">
                                                                    <a th:href="@{/admin/user/update}"
                                                                       class="btn btn-xs btn-icon-only btn-info"
                                                                       title="Cập nhật">
                                                                        <i class="icon icon-pencil mr5"></i>
                                                                    </a>

                                                                    <button th:if="${user.status == 2}"
                                                                            class="btn btn-xs yellow btn-icon-only"
                                                                            title="Mở khóa"
                                                                            th:onclick="'core_lstpage.onUpdateStatus('+${user.id}+','+${user.status}+')'">
                                                                        <i class="fa fa-check" aria-hidden="true"></i>
                                                                    </button>

                                                                    <button th:if="${user.status == 0}"
                                                                            class="btn btn-xs red btn-icon-only"
                                                                            title="Khóa"
                                                                            th:onclick="'core_lstpage.onUpdateStatus('+${user.id}+','+${user.status}+')'">
                                                                        <i class="fa fa-minus-square" aria-hidden="true"></i>
                                                                    </button>
                                                                </td>
                                                            </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-12" th:if="${list.size()} > ${pagesize}">
                                            <div class="pagination-control">
                                                <div class="row">
                                                    <div class="col-md-12 pull-right">
                                                        <div id="page-selection" class="padding-top-15 clearboth">
                                                            <ul class="pagination">
                                                                <li th:class="${isFirstPage}? 'page-item disabled' : 'page-item'">
                                                                    <a th:href="@{/admin/discount/list(pageindex=1)}"
                                                                       class="page-link">
                                                                        <span class="ms-bold fa fa-angle-double-left"></span>
                                                                    </a>
                                                                </li>
                                                                <li th:each="page : ${pages}"
                                                                    th:class="${page == currentPage ? 'page-item active' :'page-item' }">
                                                                    <a th:href="@{/admin/discount/list(pageindex=${page + 1})}"
                                                                       class="page-link">
                                                                        <span th:utext="${page+1}"></span>
                                                                    </a>
                                                                </li>
                                                                <li th:class="${isLastPage}? 'page-item disabled' : 'page-item'">
                                                                    <a th:href="@{/admin/discount/list(pageindex=${endPage})}"
                                                                       class="page-link">
                                                                        <span class="ms-bold fa fa-angle-double-right"></span></a>
                                                                </li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div><!--END LIST CONTENT-->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- END CONTENT BODY -->
            <!-- BEGIN MODAL -->
            <!-- END MODAL -->
        </div>
        <!-- END CONTENT -->
    </div>
    <!-- END CONTAINER -->
</div>
</body>
</html>
<script type="text/javascript">
    var ctorPage = {
        updateStatus: '/user/status',
        btnCssDefault: 'a.btn-df',
        TextYes: 'Có',
        TextNo: 'Không',
        TextDelAskMsg: 'Bạn có chắc chắn XÓA biểu ghi này ?'
    };

    var core_lstpage = {

        onUpdateStatus: function (_id, _status) {
            var msg = 'Bạn có chắc chắn muốn mở khóa tài khoản này không ?';
            if (_status === 0) {
                msg = 'Bạn có chắc chắn muốn khóa tài khoản này không ?';
            }
            bootbox.confirm({
                message: msg,
                buttons: {
                    confirm: {
                        label: ctorPage.TextYes,
                        className: 'btn-success'
                    },
                    cancel: {
                        label: ctorPage.TextNo,
                        className: 'btn-danger'
                    }
                },
                callback: function (result) {
                    if (result) {
                        var Book = {
                            id: _id,
                            status: _status
                        }
                        console.log(_id);
                        ShowLoading();
                        core_services.postAsync(ctorPage.updateStatus, JSON.stringify(Book)
                            , function (res) {
                                HideLoading();
                                if (res) {
                                    core_lstpage.onReload()
                                } else {
                                    // core_notification.updateFail();
                                    core_lstpage.onReload()
                                }
                                core_lstpage.onReload();
                            }
                            , function () {
                                // core_notification.updateFail();
                                core_lstpage.onReload();
                            });
                    }
                }
            });
        },

        onReload: function () {
            HideLoading();
            window.location.reload();

        },

    }
</script>